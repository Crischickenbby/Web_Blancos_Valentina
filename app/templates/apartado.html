{% extends 'punto_venta.html' %}

{% block title %}Apartados{% endblock %}

{% block styles %}
<link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='styles/apartado.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
{% endblock %}

{% block content %}
<div class="caption">
    <h1>Apartados</h1>
</div>

<div class="Buttons">
    <button id="addLayawayBtn" class="custom-button1">Añadir Apartado</button>
    <button id="deleteLayawayBtn" class="custom-button2">Eliminar Apartado</button>
    <button id="managePaymentsBtn" class="custom-button3">Gestionar Pagos</button>
    <div class="inputGroup">
        <input type="text" id="searchTable" required autocomplete="off">
        <label for="searchTable">Buscar</label>
    </div>
</div>

<article class="table-widget">
    <table>
        <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Producto</th>
                <th>Fecha de Vencimiento</th>
                <th>Monto Pendiente</th>
                <th>Opciones</th>
            </tr>
        </thead>
        <tbody>
            {% for apartado in apartados %}
            <tr>
                <td>{{ apartado.name }}</td>
                <td>{{ apartado.last_name }}</td>
                <td>{{ apartado.product_name }}</td>
                <td>{{ apartado.due_date }}</td>
                <td>${{ apartado.pending_amount }}</td>
                <td class="button-container">
                    <button class="custom-button1 edit-layaway-btn" data-id="{{ apartado.id }}">Editar</button>
                    <button class="custom-button2 delete-layaway-btn" data-id="{{ apartado.id }}">Eliminar</button>
                    <button class="custom-button3 manage-payments-btn" data-id="{{ apartado.id }}">Pagos</button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</article>

<!-- Modal para añadir apartado -->
<div id="addLayawayModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Añadir Apartado</h2>
        <form id="addLayawayForm">
            <label for="customer-name">Nombre del Cliente:</label>
            <input type="text" id="customer-name" name="customerName" required>

            <label for="customer-last-name">Apellido del Cliente:</label>
            <input type="text" id="customer-last-name" name="customerLastName" required>

            <label for="product-select">Producto:</label>
            <select id="product-select" name="productId" required>
                {% for product in productos %}
                <option value="{{ product.id }}">{{ product.name }}</option>
                {% endfor %}
            </select>

            <label for="due-date">Fecha de Vencimiento:</label>
            <input type="date" id="due-date" name="dueDate" required>

            <label for="pending-amount">Monto Pendiente:</label>
            <input type="number" id="pending-amount" name="pendingAmount" step="0.01" required>

            <button type="submit" class="custom-button1">Guardar Apartado</button>
        </form>
    </div>
</div>

<!-- Modal para gestionar pagos -->
<div id="managePaymentsModal" class="modal">
    <div class="modal-content">
        <span class="close-button">&times;</span>
        <h2>Gestionar Pagos</h2>
        <form id="managePaymentsForm">
            <label for="payment-amount">Monto a Pagar:</label>
            <input type="number" id="payment-amount" name="paymentAmount" step="0.01" required>

            <button type="submit" class="custom-button1">Registrar Pago</button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/apartado.js') }}"></script>
{% endblock %}